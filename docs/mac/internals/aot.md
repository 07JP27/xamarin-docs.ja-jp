---
title: 事前コンパイル Xamarin.Mac
description: 今後の時間 (AOT) コンパイル トレードオフおよび考慮事項
ms.prod: xamarin
ms.assetid: 38B8A017-5A58-429C-A6E9-9860A1DCEF63
ms.technology: xamarin-mac
author: bradumbaugh
ms.author: brumbaug
ms.date: 11/10/2017
ms.openlocfilehash: d6be1d6e4a3cccef827862fb1fd54b202b0ce5fd
ms.sourcegitcommit: 945df041e2180cb20af08b83cc703ecd1aedc6b0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/04/2018
---
# <a name="xamarinmac-ahead-of-time-compilation"></a>事前コンパイル Xamarin.Mac

## <a name="overview"></a>概要

事前時間 (AOT) のコンパイルでは、起動時のパフォーマンスを向上させるための強力な最適化の手法には。 ただしも影響ビルド時、アプリケーション サイズ、およびプログラムの実行で有効な方法です。 プロパティのトレードオフを理解するのをコンパイルし、アプリケーションの実行に少し詳細に知りここします。

C# および f# などのマネージ言語で記述されたコードは、IL と呼ばれる中間の表現にコンパイルされます。 ライブラリとプログラムのアセンブリに格納されている、この IL は比較的コンパクトなプロセッサ アーキテクチャ間で移植可能です。 IL が命令のおよび IL が、プロセッサに固有のマシン語コードに変換する必要がある時点で設定中間のみです。

この処理を行うことができます 2 つの点があります。

- **ジャスト イン タイム (JIT)** – スタートアップおよび IL がメモリのマシン語コードにコンパイルされたアプリケーションの実行中にします。
- **時間 (AOT) の先行**–、IL がコンパイルおよびネイティブ ライブラリに書き込むし、アプリケーション バンドル内に格納されたビルド中にします。

各オプションには、さまざまな利点とトレードオフがあります。

- **JIT**
  - **起動時間**– JIT コンパイルは、起動時に行う必要があります。 約 100 ミリ秒、これは、ほとんどのアプリケーションが、大規模なアプリケーションは、この時刻をはるかにすることができます。
  - **実行**– として、JIT コードを最適化するには特定のプロセッサが使用されているため、わずかですが優れたコードを生成できます。 ほとんどのアプリケーションでこれは、数パーセント速く多くてです。
- **AOT**
  - **起動時間**– JIT アセンブリよりもはるかに高速が事前にコンパイルされた dylib をロードします。
  - **ディスク領域が**– dylib をそれらは大量のディスク領域をただしかかることができます。 倍増 AOTed を対象のアセンブリには、に応じて以上のアプリケーションのコード部分のサイズ。
  - **ビルド時**– AOT コンパイルが大幅に遅れるその JIT し、それを使用したビルドの処理が低下します。 この遅れ秒またはコンパイルされたアセンブリの数とサイズによってはさらに、1 分までの範囲です。
  - **難読化**– として、IL をリバース エンジニア リングのマシン語コードよりも非常に簡単には、必要ではないため、機密性の高いコードを難読化し、取り除くことができます。 これには、以下について説明するオプション「ハイブリッド」が必要です。

## <a name="enabling-aot"></a>AOT を有効にします。

AOT オプションは、Mac をビルドのペインで、今後の更新プログラムに追加されます。 それまでは、AOT を有効にする必要があります Mac をビルドの「その他の mmp 引数」フィールドを使用してコマンドライン引数を渡します。 次のようなオプションがあります。


      --aot[=VALUE]          Specify assemblies that should be AOT compiled
                               - none - No AOT (default)
                               - all - Every assembly in MonoBundle
                               - core - Xamarin.Mac, System, mscorlib
                               - sdk - Xamarin.Mac.dll and BCL assemblies
                               - |hybrid after option enables hybrid AOT which
                               allows IL stripping but is slower (only valid
                               for 'all')
                                - Individual files can be included for AOT via +
                               FileName.dll and excluded via -FileName.dll

                               Examples:
                                 --aot:all,-MyAssembly.dll
                                 --aot:core,+MyOtherAssembly.dll,-mscorlib.dll



## <a name="hybrid-aot"></a>ハイブリッド AOT

MacOS アプリケーション ランタイムの実行中には、マシン語コードを使用する既定値は AOT コンパイルによって生成されたネイティブ ライブラリから読み込まれます。 ただし、JIT コンパイルが大幅にさらに最適化された結果を生成する場所の領域などのコードの一部の領域があります。 これには、使用できるマネージ アセンブリ IL が必要です。 Ios、アプリケーションが制限されて使用されるすべての JIT コンパイルです。そのコードのセクションは、AOT も自動的にコンパイルします。

ハイブリッド オプションもに IL が使用できないこと実行時に前提としていますの (iOS) のようにこれらのセクションを両方のコンパイルにコンパイラに指示します。 この IL を削除することができますし、ビルドを投稿します。 前述のように、ランタイムが強制されるようにいくつかの場所に低い最適化されたルーチンを使用します。

## <a name="further-considerations"></a>その他の注意事項

AOT の不適切な結果は、処理されたアセンブリの数とサイズをスケーリングします。 完全[ターゲット フレームワーク](~/mac/platform/target-framework.md)例には、非常に大きい基本クラス ライブラリ (BCL) モダンよりが含まれています、したがって AOT 長い時間がかかります、大規模なバンドルを生成します。 これはさらに悪化未使用のコードを除外するリンクと完全のターゲット フレームワークの非互換性をします。 最良の結果の最新かつ有効なリンクをアプリケーションの移行を検討してください。

AOT という 1 つ利点ネイティブのデバッグとプロファイリング toolchains と向上のやり取りが付属します。 コードベースの大部分は、事前コンパイルは後の関数名と、ネイティブのクラッシュ レポート、プロファイリング、およびデバッグ内読みやすくするシンボルがあります。 せず生成 JIT 関数にこれらの名前を持つして多くの場合、解決するのには非常に困難である名前のない 16 進数のオフセットとして表示。
